<!DOCTYPE html><html lang="zh-cn,en,default"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> iOS APP框架搭建 · winter</title><meta name="description" content="iOS APP框架搭建 - 廖文韬"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/css/prontera.css"><link rel="search" type="application/opensearchdescription+xml" href="https://winterliao.github.io/atom.xml" title="winter"></head><body><header class="feature-header"><nav class="component-nav"><ul><div class="logo-container"><a href="/"><h2 class="title">winter</h2></a></div><a href="/" target="_self" class="li component-nav-item"><p>主页</p></a><a href="/archives" target="_self" class="li component-nav-item"><p>归档</p></a><ul class="shortcut-icons"><a href="https://github.com/winterLiao" target="_blank"><img src="/images/github.svg" class="icon"></a></ul></ul></nav></header><main class="container"><div id="post-container"><div class="post"><article class="post-block"><h1 class="post-title">iOS APP框架搭建</h1><div class="post-info">2017年3月13日</div><div class="post-content"><p>MVC设计模式，纯代码的框架。</p>
<h2 id="1-新建工程"><a href="#1-新建工程" class="headerlink" title="1.新建工程"></a>1.新建工程</h2><h3 id="1-1-新建项目"><a href="#1-1-新建项目" class="headerlink" title="1.1 新建项目"></a>1.1 新建项目</h3><p><img src="http://ok841h9gr.bkt.clouddn.com/%E6%A1%86%E6%9E%B6%E6%90%AD%E5%BB%BA-%E5%88%A0%E9%99%A4.png" alt="删除">   </p>
<ul>
<li>删除无用的文件(Main.storyboard,ViewController)</li>
<li>删除plist文件中Main storyboard file base name一项</li>
<li>appdelegate进行修改</li>
</ul>
<figure class="highlight objectivec"><table><tr><td class="code"><pre><div class="line">- (<span class="built_in">BOOL</span>)application:(<span class="built_in">UIApplication</span> *)application didFinishLaunchingWithOptions:(<span class="built_in">NSDictionary</span> *)launchOptions</div><div class="line">&#123;</div><div class="line"><span class="keyword">self</span>.window = [[<span class="built_in">UIWindow</span> alloc] initWithFrame:[[<span class="built_in">UIScreen</span> mainScreen] bounds]];</div><div class="line"><span class="keyword">self</span>.window.backgroundColor = [<span class="built_in">UIColor</span> whiteColor];</div><div class="line"></div><div class="line"></div><div class="line">[<span class="keyword">self</span>.window makeKeyAndVisible];</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="1-2-创建不同的target管理工程"><a href="#1-2-创建不同的target管理工程" class="headerlink" title="1.2 创建不同的target管理工程"></a>1.2 创建不同的target管理工程</h3><p>有时候我们需要多个版本，开发版、测试版或者线上版，或因渠道不同需要区分企业版，AppStore版等。这个时候使用target来管理就比较方便</p>
<h4 id="1-2-1-生成"><a href="#1-2-1-生成" class="headerlink" title="1.2.1 生成"></a>1.2.1 生成</h4><p><img src="http://ok841h9gr.bkt.clouddn.com/%E6%A1%86%E6%9E%B6%E6%90%AD%E5%BB%BA-%E5%A4%9Atarget.png" alt="多target"></p>
<h4 id="1-2-2-修改名字"><a href="#1-2-2-修改名字" class="headerlink" title="1.2.2 修改名字"></a>1.2.2 修改名字</h4><p>需要修改下名字target、scheme、info.plist三项的名字，主要用来区分下版本</p>
<blockquote>
<p>注意:修改了info.plist名字需要修改新建的target的配置信息文件，让其能找到info.plist文件</p>
</blockquote>
<h4 id="1-2-3-修改下工程配置文件"><a href="#1-2-3-修改下工程配置文件" class="headerlink" title="1.2.3 修改下工程配置文件"></a>1.2.3 修改下工程配置文件</h4><p><img src="http://ok841h9gr.bkt.clouddn.com/%E6%A1%86%E6%9E%B6%E6%90%AD%E5%BB%BA-%E5%A4%9Ataget2.png" alt=""><br>就可以这样使用了：<br><figure class="highlight cpp"><table><tr><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">if</span> DEVELOPMENT</span></div><div class="line">NSLog(@<span class="string">"development"</span>);</div><div class="line"><span class="meta">#<span class="meta-keyword">else</span></span></div><div class="line">NSLog(@<span class="string">"release"</span>);</div><div class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></div></pre></td></tr></table></figure></p>
<h4 id="使用方法可参考-多个Target管理"><a href="#使用方法可参考-多个Target管理" class="headerlink" title="使用方法可参考:多个Target管理"></a>使用方法可参考:<a href="http://blog.csdn.net/fys_0801/article/details/52585954">多个Target管理</a></h4><h3 id="1-3-导入CocoaPods管理依赖库"><a href="#1-3-导入CocoaPods管理依赖库" class="headerlink" title="1.3 导入CocoaPods管理依赖库"></a>1.3 导入CocoaPods管理依赖库</h3><p>自从CocoaPods升级到1.0.1之后,为多个target导入依赖库,之前的link_with语法不能用了,使用如下方法:</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><div class="line">source <span class="string">'https://github.com/CocoaPods/Specs.git'</span></div><div class="line">platform <span class="symbol">:ios</span>, ‘<span class="number">7.0</span>’</div><div class="line"></div><div class="line"><span class="comment"># ruby语法</span></div><div class="line"><span class="comment"># target数组 如果有新的target直接加入该数组</span></div><div class="line">targetsArray = [‘MyApp’, ‘MyAppTest’]</div><div class="line"><span class="comment"># 循环</span></div><div class="line">targetsArray.each <span class="keyword">do</span> <span class="params">|t|</span></div><div class="line">target t <span class="keyword">do</span></div><div class="line">pod <span class="string">'MJRefresh'</span>, <span class="string">'~&gt; 3.1.12'</span></div><div class="line">pod <span class="string">'Masonry'</span>, <span class="string">'~&gt; 0.6.1'</span></div><div class="line">pod <span class="string">'AFNetworking'</span>, <span class="string">'~&gt; 3.1.0'</span></div><div class="line">pod <span class="string">'MJExtension'</span></div><div class="line">pod <span class="string">'MBProgressHUD'</span></div><div class="line">pod <span class="string">'SDWebImage'</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<h4 id="使用方法可参考：CocoaPods安装教程"><a href="#使用方法可参考：CocoaPods安装教程" class="headerlink" title="使用方法可参考：CocoaPods安装教程"></a>使用方法可参考：<a href="http://www.cocoachina.com/ios/20160922/17622.html">CocoaPods安装教程</a></h4><h3 id="1-4-info-plist配置"><a href="#1-4-info-plist配置" class="headerlink" title="1.4 info.plist配置"></a>1.4 info.plist配置</h3><h5 id="1-4-1-开启http的访问权限"><a href="#1-4-1-开启http的访问权限" class="headerlink" title="1.4.1 开启http的访问权限"></a>1.4.1 开启http的访问权限</h5><p>info.plist 中添加以下<br><img src="http://ok841h9gr.bkt.clouddn.com/%E6%A1%86%E6%9E%B6%E6%90%AD%E5%BB%BA-http%E8%AE%BF%E9%97%AE%E5%BC%80%E5%90%AF.png" alt="http访问"></p>
<h4 id="1-4-2-添加应用白名单"><a href="#1-4-2-添加应用白名单" class="headerlink" title="1.4.2 添加应用白名单"></a>1.4.2 添加应用白名单</h4><p>iOS9之后分享等必须添加白名单后才可以打开相关应用。字段值为LSApplicationQueriesSchemes<br><img src="http://ok841h9gr.bkt.clouddn.com/%E6%A1%86%E6%9E%B6%E6%90%AD%E5%BB%BA-%E7%99%BD%E5%90%8D%E5%8D%95.png" alt="应用白名单"></p>
<h4 id="1-4-3-其他"><a href="#1-4-3-其他" class="headerlink" title="1.4.3 其他"></a>1.4.3 其他</h4><p>设置分享到微信、微博啊等URL Types</p>
<h2 id="2-项目模块化"><a href="#2-项目模块化" class="headerlink" title="2.项目模块化"></a>2.项目模块化</h2><h3 id="2-1-分类各模块"><a href="#2-1-分类各模块" class="headerlink" title="2.1 分类各模块"></a>2.1 分类各模块</h3><p>分类具体按照业务需求去归类，开发前把大体的分类号，主体的文件夹建立真实的文件夹，再把真实的文件夹拖到项目中，这样的好处是，避免了在项目中创建虚拟文件夹，然后导致各类文件都放在一块，不方便查找。<br>大致分类：<br><img src="http://ok841h9gr.bkt.clouddn.com/%E6%A1%86%E6%9E%B6%E6%90%AD%E5%BB%BA-%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84.png" alt=""></p>
<h3 id="2-2-导入需要用的第三方库"><a href="#2-2-导入需要用的第三方库" class="headerlink" title="2.2 导入需要用的第三方库"></a>2.2 导入需要用的第三方库</h3><p>先使用CocoaPods导入项目中一些常用的第三方库,后续再根据需求导入，有些无法用CocoaPods导入的或者是一些需要修改库中代码的拖入到工程中Vender文件夹中</p>
<h3 id="2-3-创建pch文件"><a href="#2-3-创建pch文件" class="headerlink" title="2.3 创建pch文件"></a>2.3 创建pch文件</h3><p>这个文件用来包含全局使用的头文件，例如:<br>1.第三方头文件<br>2.全局宏定义<br>3.自定义的头文件包含主题、网络请求地址、全局方法、key等</p>
<h4 id="使用方法参考-Pch-文件的正确使用"><a href="#使用方法参考-Pch-文件的正确使用" class="headerlink" title="使用方法参考: Pch 文件的正确使用"></a>使用方法参考: <a href="http://www.jianshu.com/p/67ce72c4ad6c">Pch 文件的正确使用</a></h4><h2 id="3-全局的宏定义"><a href="#3-全局的宏定义" class="headerlink" title="3 全局的宏定义"></a>3 全局的宏定义</h2><p>具体方法大家可下载demo看下<br><img src="http://ok841h9gr.bkt.clouddn.com/%E6%A1%86%E6%9E%B6%E6%90%AD%E5%BB%BA-%E5%85%A8%E5%B1%80%E5%AE%9A%E4%B9%892.png" alt="宏定义"></p>
<h3 id="3-1-全局配置参数DefineMacro"><a href="#3-1-全局配置参数DefineMacro" class="headerlink" title="3.1 全局配置参数DefineMacro"></a>3.1 全局配置参数DefineMacro</h3><p>全局宏定义包含一些屏幕宽高、iOS版本、手机类型等<br><figure class="highlight stylus"><table><tr><td class="code"><pre><div class="line"><span class="number">#def</span>ine SCREEN_WIDTH   [UIScreen mainScreen]<span class="selector-class">.bounds</span><span class="selector-class">.size</span><span class="selector-class">.width</span></div><div class="line"><span class="number">#def</span>ine SCREENH_HEIGHT [UIScreen mainScreen]<span class="selector-class">.bounds</span><span class="selector-class">.size</span><span class="selector-class">.height</span></div><div class="line"><span class="comment">//随机颜色</span></div><div class="line"><span class="number">#def</span>ine KRandomColor [UIColor colorWithRed:arc4random_uniform(<span class="number">256</span>)/<span class="number">255.0</span> green:arc4random_uniform(<span class="number">256</span>)/<span class="number">255.0</span> blue:arc4random_uniform(<span class="number">256</span>)/<span class="number">255.0</span> alpha:<span class="number">1.0</span>]</div></pre></td></tr></table></figure></p>
<h3 id="3-2-样式定义DefineTheme"><a href="#3-2-样式定义DefineTheme" class="headerlink" title="3.2 样式定义DefineTheme"></a>3.2 样式定义DefineTheme</h3><p>主要包含样式上的定义,主题颜色、各类字体大小颜色、控件大小等<br><figure class="highlight cpp"><table><tr><td class="code"><pre><div class="line"><span class="comment">//颜色</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> TITLE_COLOR [UIColor blackColor]<span class="comment">//标题颜色</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> TEXT_COLOR [UIColor grayColor]<span class="comment">//正文颜色</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> TIPTEXT_COLOR UIColorFromRGB(0x888888)<span class="comment">//提示语文本颜色</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAIN_GROUNDCOLOR UIColorFromRGB(0xF98B1B)<span class="comment">//主题景色</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> BACKGROUNDCOLOR UIColorFromRGB(0xF7F7F7)<span class="comment">//背景颜色</span></span></div><div class="line"><span class="comment">//字体大小</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> TITLEFONT [UIFont systemFontOfSize:18]</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> TEXTFONT [UIFont systemFontOfSize:16]</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> TIPTEXTFONT [UIFont systemFontOfSize:12]</span></div></pre></td></tr></table></figure></p>
<h3 id="3-3-API地址DefineRequest"><a href="#3-3-API地址DefineRequest" class="headerlink" title="3.3 API地址DefineRequest"></a>3.3 API地址DefineRequest</h3><p>访问的地址，各个接口的查询<br><figure class="highlight cpp"><table><tr><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">if</span> DEVELOPMENT <span class="comment">//***************开发版本*************</span></span></div><div class="line"><span class="comment">//****************测试环境***********</span></div><div class="line"><span class="comment">//app服务重构测试</span></div><div class="line"><span class="comment">//#define BaseURLString   @"http://www-test.baidu.com/rest/post"//beta</span></div><div class="line"><span class="comment">//#define BaseURLString @"http://docker-branch02-web-tomcat.baidu.com:8080/rest/post"//分之域名</span></div><div class="line"><span class="comment">//****************开发环境(个人服务器)************</span></div><div class="line"><span class="comment">//后台XXX</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> BaseURLString  @<span class="meta-string">"http://192.168.1.175:8080/baidu/rest/post"</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">else</span>          <span class="comment">//**************生产版本**************</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> BaseURLString @<span class="meta-string">"https://www.baidu.com/rest/post"</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></div><div class="line"></div><div class="line"><span class="comment">//****************接口说明************</span></div><div class="line"><span class="comment">//获取用户信息</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> Request_type_getUserInfo @<span class="meta-string">"getUserInfo"</span></span></div><div class="line"><span class="comment">//首页广告</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> Request_type_queryBannerByType @<span class="meta-string">"queryBannerByType"</span></span></div></pre></td></tr></table></figure></p>
<h2 id="4-初期代码编写"><a href="#4-初期代码编写" class="headerlink" title="4. 初期代码编写"></a>4. 初期代码编写</h2><p><img src="http://ok841h9gr.bkt.clouddn.com/%E6%A1%86%E6%9E%B6%E6%90%AD%E5%BB%BA-%E5%85%AC%E5%85%B1%E7%B1%BB.png" alt="公共类"></p>
<h3 id="4-1-Category"><a href="#4-1-Category" class="headerlink" title="4.1 Category"></a>4.1 Category</h3><h4 id="4-1-1-Method-swizzling"><a href="#4-1-1-Method-swizzling" class="headerlink" title="4.1.1 Method swizzling"></a>4.1.1 Method swizzling</h4><p>为Controller添加一些方法，即可省略继承baseViewController的麻烦，还可以对各工厂类进行操作</p>
<figure class="highlight objectivec"><table><tr><td class="code"><pre><div class="line"><span class="meta">#import <span class="meta-string">"UIViewController+swizzling.h"</span></span></div><div class="line"><span class="meta">#import <span class="meta-string">&lt;objc/runtime.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">UIViewController</span> (<span class="title">swizzling</span>)</span></div><div class="line"></div><div class="line">+ (<span class="keyword">void</span>)load &#123;</div><div class="line">Method fromMethod = class_getInstanceMethod([<span class="keyword">self</span> <span class="keyword">class</span>], <span class="keyword">@selector</span>(viewDidLoad));</div><div class="line">Method toMethod = class_getInstanceMethod([<span class="keyword">self</span> <span class="keyword">class</span>], <span class="keyword">@selector</span>(swizzlingViewDidLoad));</div><div class="line"></div><div class="line"><span class="keyword">if</span> (!class_addMethod([<span class="keyword">self</span> <span class="keyword">class</span>], <span class="keyword">@selector</span>(swizzlingViewDidLoad), method_getImplementation(toMethod), method_getTypeEncoding(toMethod))) &#123;</div><div class="line">method_exchangeImplementations(fromMethod, toMethod);</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// 我们自己实现的方法，也就是和self的viewDidLoad方法进行交换的方法。</span></div><div class="line">- (<span class="keyword">void</span>)swizzlingViewDidLoad &#123;</div><div class="line"><span class="built_in">NSString</span> *str = [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"%@"</span>, <span class="keyword">self</span>.class];</div><div class="line"><span class="keyword">if</span>(![str containsString:<span class="string">@"UI"</span>])&#123;</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"统计打点 : %@"</span>, <span class="keyword">self</span>.title);</div><div class="line">&#125;</div><div class="line">[<span class="keyword">self</span> swizzlingViewDidLoad];</div><div class="line">&#125;</div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<h4 id="4-1-2-appDelegate添加category"><a href="#4-1-2-appDelegate添加category" class="headerlink" title="4.1.2 appDelegate添加category"></a>4.1.2 appDelegate添加category</h4><p>用以简化appDelegate中代码</p>
<h5 id="AppDelegate-ViewController-h"><a href="#AppDelegate-ViewController-h" class="headerlink" title="AppDelegate+ViewController.h"></a>AppDelegate+ViewController.h</h5><figure class="highlight inform7"><table><tr><td class="code"><pre><div class="line">- (void)setAppWindows</div><div class="line">&#123;</div><div class="line">self.window = <span class="comment">[<span class="comment">[UIWindow alloc]</span> initWithFrame:<span class="comment">[<span class="comment">[UIScreen mainScreen]</span> bounds]</span>]</span>;</div><div class="line">self.window.backgroundColor = <span class="comment">[UIColor whiteColor]</span>;</div><div class="line"></div><div class="line"><span class="comment">[<span class="comment">[UINavigationBar appearance]</span> setTitleTextAttributes:@&#123;NSForegroundColorAttributeName: <span class="comment">[UIColor whiteColor]</span>&#125;]</span>;</div><div class="line"></div><div class="line"><span class="comment">[self.window makeKeyAndVisible]</span>;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)setRootViewController</div><div class="line">&#123;</div><div class="line">AppDelegate *app = (AppDelegate *)<span class="comment">[<span class="comment">[UIApplication sharedApplication]</span> delegate]</span>;</div><div class="line">app.window.rootViewController = <span class="comment">[<span class="comment">[RootTabViewController alloc]</span> init]</span>;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h5 id="AppDelegate-AppService-h"><a href="#AppDelegate-AppService-h" class="headerlink" title="AppDelegate+AppService.h"></a>AppDelegate+AppService.h</h5><p>需要处理的各类服务都可以添加在这<br><figure class="highlight dart"><table><tr><td class="code"><pre><div class="line"><span class="comment"><span class="markdown">/**</div><div class="line"><span class="bullet">*  </span>系统配置</div><div class="line">*/</span></span></div><div class="line">- (<span class="keyword">void</span>)systemConfigration;</div><div class="line"></div><div class="line"><span class="comment"><span class="markdown">/**</div><div class="line"><span class="bullet">*  </span>友盟注册</div><div class="line">*/</span></span></div><div class="line">- (<span class="keyword">void</span>)registerUmeng;</div><div class="line"><span class="comment"><span class="markdown">/**</div><div class="line"><span class="bullet">*  </span>个推注册</div><div class="line">*/</span></span></div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)registerGeiTui;</div><div class="line"></div><div class="line"><span class="comment"><span class="markdown">/**</div><div class="line"><span class="bullet">*  </span>检查更新</div><div class="line">*/</span></span></div><div class="line">- (<span class="keyword">void</span>)checkAppUpDataWithshowOption:(BOOL)showOption;</div><div class="line"></div><div class="line"><span class="comment"><span class="markdown">/**</div><div class="line"><span class="bullet">*  </span>获取用户信息</div><div class="line">*/</span></span></div><div class="line">- (<span class="keyword">void</span>)getUserData;</div></pre></td></tr></table></figure></p>
<h3 id="4-2-DataMange"><a href="#4-2-DataMange" class="headerlink" title="4.2 DataMange"></a>4.2 DataMange</h3><ul>
<li>存放对文件的处理方法，文件的路径</li>
<li>数据库的处理</li>
<li>NSUserDefault的处理<h3 id="4-3-Other"><a href="#4-3-Other" class="headerlink" title="4.3 Other"></a>4.3 Other</h3>建一个类存放比较杂乱的一些公共方法<figure class="highlight mipsasm"><table><tr><td class="code"><pre><div class="line"><span class="comment">/**验证该字符串是否是6-16位字母和数字组合*/</span></div><div class="line">+ (<span class="keyword">BOOL)checkIsDigitalAndLetter:(NSString </span>*)string<span class="comment">;</span></div><div class="line"><span class="comment">/**利用正则表达式验证手机号码*/</span></div><div class="line">+ (<span class="keyword">BOOL)checkTel:(NSString </span>*)str<span class="comment">;</span></div><div class="line"><span class="comment">/**利用正则表达式验证邮箱*/</span></div><div class="line">+ (<span class="keyword">BOOL)checkEmail:(NSString </span>*)email<span class="comment">;</span></div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="4-4-UITools"><a href="#4-4-UITools" class="headerlink" title="4.4 UITools"></a>4.4 UITools</h3><p>一些公共控件的封装，常用的一些控件进行封装（弹窗、广告轮播等），方便以后统一修改</p>
<h4 id="4-4-1-NavigationViewController封装"><a href="#4-4-1-NavigationViewController封装" class="headerlink" title="4.4.1 NavigationViewController封装"></a>4.4.1 NavigationViewController封装</h4><figure class="highlight objectivec"><table><tr><td class="code"><pre><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">LWTNavigationViewController</span> ()&lt;<span class="title">UINavigationControllerDelegate</span>&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">weak</span>) <span class="keyword">id</span> popDelegate;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">LWTNavigationViewController</span></span></div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</div><div class="line">[<span class="keyword">super</span> viewDidLoad];</div><div class="line"></div><div class="line"><span class="keyword">self</span>.popDelegate = <span class="keyword">self</span>.interactivePopGestureRecognizer.delegate;</div><div class="line"><span class="keyword">self</span>.delegate = <span class="keyword">self</span>;</div><div class="line"></div><div class="line"><span class="comment">//navigationBar样式设置</span></div><div class="line"><span class="keyword">self</span>.navigationBar.barTintColor = MAIN_GROUNDCOLOR;</div><div class="line">[<span class="keyword">self</span>.navigationBar setTitleTextAttributes:@&#123;<span class="built_in">NSForegroundColorAttributeName</span> : WHITCOLOR, <span class="built_in">NSFontAttributeName</span> : [<span class="built_in">UIFont</span> boldSystemFontOfSize:<span class="number">18</span>]&#125;];</div><div class="line">[<span class="keyword">self</span>.navigationBar setTintColor:WHITCOLOR];    <span class="comment">// Do any additional setup after loading the view.</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//解决手势失效问题</span></div><div class="line">- (<span class="keyword">void</span>)navigationController:(<span class="built_in">UINavigationController</span> *)navigationController didShowViewController:(<span class="built_in">UIViewController</span> *)viewController animated:(<span class="built_in">BOOL</span>)animated</div><div class="line">&#123;</div><div class="line"><span class="keyword">if</span> (viewController == <span class="keyword">self</span>.viewControllers[<span class="number">0</span>]) &#123;</div><div class="line"><span class="keyword">self</span>.interactivePopGestureRecognizer.delegate = <span class="keyword">self</span>.popDelegate;</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line"><span class="keyword">self</span>.interactivePopGestureRecognizer.delegate = <span class="literal">nil</span>;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//push时隐藏tabbar</span></div><div class="line">- (<span class="keyword">void</span>)pushViewController:(<span class="built_in">UIViewController</span> *)viewController animated:(<span class="built_in">BOOL</span>)animated</div><div class="line">&#123;</div><div class="line"><span class="keyword">if</span> (<span class="keyword">self</span>.viewControllers.count &gt; <span class="number">0</span>) &#123;</div><div class="line">viewController.hidesBottomBarWhenPushed = <span class="literal">YES</span>;</div><div class="line">&#125;</div><div class="line">[<span class="keyword">super</span> pushViewController:viewController animated:animated];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//设置样式</span></div><div class="line">- (<span class="built_in">UIStatusBarStyle</span>)preferredStatusBarStyle</div><div class="line">&#123;</div><div class="line"><span class="keyword">return</span> <span class="built_in">UIStatusBarStyleLightContent</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//设置返回按钮样式</span></div><div class="line">- (<span class="keyword">void</span>)navigationController:(<span class="built_in">UINavigationController</span> *)navigationController willShowViewController:(<span class="built_in">UIViewController</span> *)viewController animated:(<span class="built_in">BOOL</span>)animated</div><div class="line">&#123;</div><div class="line"></div><div class="line"><span class="built_in">UIBarButtonItem</span> *backBarButtonItem = [[<span class="built_in">UIBarButtonItem</span> alloc] initWithTitle:<span class="string">@"返回"</span> style:<span class="built_in">UIBarButtonItemStylePlain</span> target:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(backBarButtonItemAction)];</div><div class="line">viewController.navigationItem.backBarButtonItem = backBarButtonItem;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)backBarButtonItemAction</div><div class="line">&#123;</div><div class="line">[<span class="keyword">self</span> popViewControllerAnimated:<span class="literal">YES</span>];</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)didReceiveMemoryWarning &#123;</div><div class="line">[<span class="keyword">super</span> didReceiveMemoryWarning];</div><div class="line"><span class="comment">// Dispose of any resources that can be recreated.</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<h4 id="4-4-2-tabBarController封装"><a href="#4-4-2-tabBarController封装" class="headerlink" title="4.4.2 tabBarController封装"></a>4.4.2 tabBarController封装</h4><figure class="highlight objectivec"><table><tr><td class="code"><pre><div class="line"><span class="meta">#import <span class="meta-string">"RootTabViewController.h"</span></span></div><div class="line"><span class="meta">#import <span class="meta-string">"LWTNavigationViewController.h"</span></span></div><div class="line"></div><div class="line"><span class="meta"># define kTabbarSelectTintColor [UIColor brownColor]</span></div><div class="line"><span class="meta"># define kTabbarNormalTintColor [UIColor blackColor]</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">RootTabViewController</span> ()&lt;<span class="title">UITabBarControllerDelegate</span>&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">@end</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">RootTabViewController</span></span></div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</div><div class="line">[<span class="keyword">super</span> viewDidLoad];</div><div class="line"></div><div class="line">[<span class="keyword">self</span> buildUI];</div><div class="line"><span class="comment">// Do any additional setup after loading the view.</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/**构建视图*/</span></div><div class="line">- (<span class="keyword">void</span>)buildUI&#123;</div><div class="line"></div><div class="line"><span class="keyword">self</span>.tabBar.translucent     = <span class="literal">NO</span>;</div><div class="line"><span class="keyword">self</span>.tabBar.backgroundImage = [CommonMethods createImageWithColor:[<span class="built_in">UIColor</span> clearColor]];</div><div class="line"><span class="keyword">self</span>.tabBar.shadowImage     = [CommonMethods createImageWithColor:[<span class="built_in">UIColor</span> grayColor]];</div><div class="line"></div><div class="line"><span class="built_in">NSArray</span> * normalItems       = @[<span class="string">@"home_gray"</span>,<span class="string">@"circle_gray"</span>,<span class="string">@"me"</span>];</div><div class="line"><span class="built_in">NSArray</span> * selectItmes       = @[<span class="string">@"home_blue"</span>,<span class="string">@"circle_blue"</span>,<span class="string">@"me_blue"</span>];</div><div class="line"></div><div class="line"><span class="built_in">NSArray</span> * controllClass     = @[<span class="string">@"HomePageViewController"</span>,<span class="string">@"MessageViewController"</span>,<span class="string">@"MyViewController"</span>];</div><div class="line"><span class="keyword">self</span>.delegate               = <span class="keyword">self</span>;</div><div class="line"><span class="built_in">NSArray</span> * itemTitles        = @[<span class="string">@"首页"</span>,<span class="string">@"信息"</span>,<span class="string">@"我"</span>];</div><div class="line"><span class="built_in">NSMutableArray</span> * controllers = [[<span class="built_in">NSMutableArray</span> alloc]init];</div><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; normalItems.count; i++)</div><div class="line">&#123;</div><div class="line"><span class="built_in">UIViewController</span> * homeview =[[<span class="built_in">NSClassFromString</span>(controllClass[i]) alloc]init];</div><div class="line">LWTNavigationViewController * navigation =[[LWTNavigationViewController alloc]initWithRootViewController:homeview];</div><div class="line">navigation.tabBarItem.image                     = [[<span class="built_in">UIImage</span> imageNamed:normalItems[i]] imageWithRenderingMode:<span class="built_in">UIImageRenderingModeAlwaysOriginal</span>];</div><div class="line">navigation.tabBarItem.selectedImage             = [[<span class="built_in">UIImage</span> imageNamed:selectItmes[i]] imageWithRenderingMode:<span class="built_in">UIImageRenderingModeAlwaysOriginal</span>];</div><div class="line">navigation.tabBarItem.titlePositionAdjustment   = <span class="built_in">UIOffsetMake</span>(<span class="number">0</span>,<span class="number">-3</span>);</div><div class="line">[controllers addObject:navigation];</div><div class="line"></div><div class="line"><span class="comment">// 设置文字的样式</span></div><div class="line"><span class="built_in">NSMutableDictionary</span> *textAttrs                  = [<span class="built_in">NSMutableDictionary</span> dictionary];</div><div class="line">textAttrs[<span class="built_in">NSForegroundColorAttributeName</span>]       = kTabbarNormalTintColor;</div><div class="line"><span class="built_in">NSMutableDictionary</span> *selectTextAttrs            = [<span class="built_in">NSMutableDictionary</span> dictionary];</div><div class="line">selectTextAttrs[<span class="built_in">NSForegroundColorAttributeName</span>] = kTabbarSelectTintColor;</div><div class="line">[homeview.tabBarItem setTitleTextAttributes:textAttrs forState:<span class="built_in">UIControlStateNormal</span>];</div><div class="line">[homeview.tabBarItem setTitleTextAttributes:selectTextAttrs forState:<span class="built_in">UIControlStateSelected</span>];</div><div class="line"><span class="comment">// 设置tabbaritem 的title</span></div><div class="line">navigation.tabBarItem.title                     = itemTitles[i];</div><div class="line">&#125;</div><div class="line"><span class="keyword">self</span>.viewControllers = controllers;</div><div class="line">&#125;</div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<h3 id="4-5-第三方库的封装"><a href="#4-5-第三方库的封装" class="headerlink" title="4.5 第三方库的封装"></a>4.5 第三方库的封装</h3><h4 id="4-5-1-网络框架"><a href="#4-5-1-网络框架" class="headerlink" title="4.5.1 网络框架"></a>4.5.1 网络框架</h4><figure class="highlight objectivec"><table><tr><td class="code"><pre><div class="line"><span class="comment">//基本参数设置</span></div><div class="line">+ (AFHTTPSessionManager *)httpManager&#123;</div><div class="line"><span class="comment">//获取请求对象</span></div><div class="line">AFHTTPSessionManager *manager = [AFHTTPSessionManager manager];</div><div class="line"><span class="comment">// 设置请求格式</span></div><div class="line">manager.requestSerializer = [AFJSONRequestSerializer serializer];</div><div class="line"><span class="comment">// 设置返回格式</span></div><div class="line">manager.responseSerializer = [AFHTTPResponseSerializer serializer];</div><div class="line">[manager.requestSerializer setValue:<span class="string">@"application/json"</span> forHTTPHeaderField:<span class="string">@"Accept"</span>];</div><div class="line">[manager.requestSerializer setValue:<span class="string">@"application/json"</span> forHTTPHeaderField:<span class="string">@"Content-Type"</span>];</div><div class="line">manager.requestSerializer.timeoutInterval = RequestTimeOut;</div><div class="line"><span class="keyword">return</span> manager;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//请求处理</span></div><div class="line">+ (<span class="keyword">void</span>)postParameters:(<span class="keyword">id</span>)parameters</div><div class="line">success:(<span class="keyword">void</span> (^)(<span class="built_in">NSDictionary</span> *resDict))success</div><div class="line">failure:(<span class="keyword">void</span> (^)(<span class="built_in">NSError</span> *error))failure</div><div class="line">&#123;</div><div class="line"></div><div class="line"><span class="comment">//    if ([[AFNetworkReachabilityManager sharedManager] networkReachabilityStatus] &lt;= 0) &#123;</span></div><div class="line"><span class="comment">//        [MBProgressHUD showMessageInWindow:@"网络无连接" afterDelayHide:AfterDelayHide];</span></div><div class="line"><span class="comment">//        return;</span></div><div class="line"><span class="comment">//    &#125;</span></div><div class="line">AFHTTPSessionManager *manager = [<span class="keyword">self</span> httpManager];</div><div class="line"><span class="comment">//开始请求</span></div><div class="line">[manager POST:BaseURLString</div><div class="line">parameters:parameters</div><div class="line">progress:^(<span class="built_in">NSProgress</span> * _Nonnull uploadProgress) &#123;</div><div class="line">&#125;</div><div class="line">success:^(<span class="built_in">NSURLSessionDataTask</span> * _Nonnull task, <span class="keyword">id</span>  _Nullable responseObject) &#123;</div><div class="line"><span class="built_in">NSMutableDictionary</span> *resDict = (<span class="built_in">NSMutableDictionary</span> *)[responseObject mj_JSONObject];</div><div class="line"><span class="comment">//              NSDictionary *dict = [HttpManager checkResultVaild:resDict withFunction:parameters[@"function"]];</span></div><div class="line"></div><div class="line"><span class="comment">//这里可以处理数据 针对接口返回的特定参数进行处理，如单点登录等需求</span></div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"\n接口：%@\n返回数据：%@"</span>,parameters[<span class="string">@"function"</span>],[[<span class="built_in">NSString</span> alloc] initWithData:responseObject encoding:<span class="built_in">NSUTF8StringEncoding</span>]);</div><div class="line"></div><div class="line">success(resDict);</div><div class="line">&#125;</div><div class="line">failure:^(<span class="built_in">NSURLSessionDataTask</span> * _Nullable task, <span class="built_in">NSError</span> * _Nonnull error) &#123;</div><div class="line">failure(error);</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"\n当前接口：%@\n错误信息：%@"</span>,parameters[<span class="string">@"function"</span>],error);</div><div class="line">&#125;];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="4-5-2-其他第三方"><a href="#4-5-2-其他第三方" class="headerlink" title="4.5.2 其他第三方"></a>4.5.2 其他第三方</h4><p>UM、HUD等很多第三方框架，都需要进行封装，针对自己app需求进行配置，使用起来就比较方便。</p>
<h2 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h2><p>有什么建议可以提出来，有更好的欢迎探讨，不定期更新<br><a href="https://github.com/winterLiao/MyAppDemo">demo下载</a></p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p>文中的内容有参考过以下文章，大家可以参考下<br><a href="http://blog.csdn.net/fys_0801/article/details/52585954">多个Target管理</a><br><a href="http://www.cocoachina.com/ios/20160922/17622.html">CocoaPods安装教程</a><br><a href="http://www.jianshu.com/p/67ce72c4ad6c">Pch 文件的正确使用</a><br><a href="http://www.jianshu.com/p/ff19c04b34d0">iOS黑魔法－Method Swizzling</a><br><a href="http://www.jianshu.com/p/0c6f3f4b3b34">手把手教你iOS项目基本框架</a></p>
</div></article></div><div id="disqus_thread"></div></div><script>var disqus_shortname = 'Winter';
var disqus_identifier = '2017/03/13/frameWork/';
var disqus_title = 'iOS APP框架搭建';
var disqus_url = 'https://winterliao.github.io/2017/03/13/frameWork/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//Winter.disqus.com/count.js" async></script></main><footer class="footer-container"><div class="paginator"><a href="/2017/03/18/swift-different/" class="prev">上一篇</a><a href="/2017/02/21/textView/" class="next">下一篇</a></div><div class="copyright"><p>© 2017 - 2018 <a href="https://winterliao.github.io">廖文韬</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/AngryPowman/hexo-theme-prontera" target="_blank">hexo-theme-prontera</a>.</p></div></footer><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"Winter",'auto');ga('send','pageview');</script></body></html>